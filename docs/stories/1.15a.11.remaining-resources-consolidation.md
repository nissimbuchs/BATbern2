# Story 1.15a.11: Remaining Resources API Consolidation

## Status
Draft

## Story

**As a** developer,
**I want** consolidated APIs for remaining miscellaneous resources not yet assigned to domain services,
**so that** all API endpoints follow consistent patterns and are properly assigned to services.

## Domain Context

### Primary Domain
Shared Infrastructure & Core Services - Admin utilities and infrastructure endpoints

### Involved Services
- API Gateway (admin endpoints, system monitoring)
- Shared Kernel (query utilities from Story 1.15a)

### Cross-Domain Dependencies
- **Depends on**: Story 1.15a (API Consolidation Foundation)
- **Depends on**: Stories 1.15a.1-1.15a.10 for related resources
- **Note**: Many resources originally listed here have been reassigned to proper domain services

## Requirements Context

### Related Functional Requirements
- Various FRs across miscellaneous features

### Acceptance Criteria Source
API Consolidation Analysis (docs/api-consolidation-analysis.md), Phase 3 - Other Resources

## Architecture Context

### Architecture Patterns
[Source: docs/api-consolidation-analysis.md]
- **Remaining Endpoints**: ~50-100 miscellaneous endpoints
- **Consolidation Target**: ~30-50 endpoints
- **Reduction**: ~40-50%

## Resources Reassigned to Domain Services

The following resources have been moved to their appropriate domain services:

### ✅ Moved to Event Management Service (Story 1.15a.1)
- **Sessions** - Already nested as `/api/v1/events/{id}/sessions`
- **Registrations** - Already nested as `/api/v1/events/{id}/registrations`
- **Venues** - Already included as `/api/v1/events/{id}/venue`
- **Planning/Timeline** - Already included as `/api/v1/events/{id}/workflow` and `/api/v1/events/{id}/timeline`

### ✅ Moved to Speaker Coordination Service (Story 1.15a.3)
- **Invitations** - See updated Story 1.15a.3 for speaker invitation endpoints
- **Presentations** - See updated Story 1.15a.3 for speaker materials/presentations

### ✅ Moved to Company Management Service (Story 1.15a.6)
- **Files** - Already comprehensively implemented with presigned URLs, CDN integration, storage quotas (see Company Management API docs)

### ✅ Moved to Attendee Experience Service (Story 1.15a.4)
- **Archive** - Historical content search and discovery (see updated Story 1.15a.4)

## Remaining Admin Endpoints (Infrastructure Level)

### Admin System Endpoints (13 endpoints)
These are infrastructure/API Gateway level endpoints, not domain service endpoints:

```
# System Health & Monitoring
GET    /api/v1/admin/system/status
GET    /api/v1/admin/system/metrics
GET    /api/v1/admin/system/health

# Audit & Logging
GET    /api/v1/admin/audit-logs?filter={}&page={}
GET    /api/v1/admin/audit-logs/{id}

# Feature Management
GET    /api/v1/admin/feature-flags
POST   /api/v1/admin/feature-flags
PUT    /api/v1/admin/feature-flags/{id}
DELETE /api/v1/admin/feature-flags/{id}

# System Configuration
GET    /api/v1/admin/config
PUT    /api/v1/admin/config/{key}

# Cache Management
POST   /api/v1/admin/cache/clear
GET    /api/v1/admin/cache/stats
```

## Acceptance Criteria

1. **Admin System Health**: System status and metrics endpoints
2. **Admin Audit Logs**: Access to system audit logs with filtering
3. **Admin Feature Flags**: Feature flag management (CRUD operations)
4. **Admin Configuration**: System configuration management
5. **Admin Cache Management**: Cache clearing and statistics
6. **Standard Patterns**: All admin endpoints follow REST conventions
7. **Authorization**: All admin endpoints require admin role
8. **Rate Limiting**: Admin endpoints have appropriate rate limits
9. **Documentation**: OpenAPI spec for all admin endpoints
10. **Testing**: All admin endpoints have >90% test coverage

## Estimated Consolidation

**Note**: Most resources originally planned for this story have been reassigned to their proper domain services.

**Remaining Admin Endpoints**: ~13 endpoints (infrastructure level)
**Pattern**: Infrastructure/API Gateway endpoints, not domain microservices

## Performance Requirements

- Admin system status: <100ms (P95)
- Admin metrics query: <300ms (P95)
- Audit log queries: <400ms (P95)
- Feature flag operations: <150ms (P95)
- Cache operations: <200ms (P95)

## Definition of Done

- [ ] All 10 ACs implemented
- [ ] All admin endpoints implemented at API Gateway level
- [ ] Proper admin role authorization enforced
- [ ] All APIs follow standard REST patterns
- [ ] OpenAPI specs generated for admin endpoints
- [ ] Tests >90% coverage
- [ ] Rate limiting configured
- [ ] Audit logging enabled for all admin operations

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-12 | 2.0 | Major restructuring: Reassigned most resources to proper domain services; refocused story on Admin endpoints only | Winston (Architect) |
| 2024-10-04 | 1.0 | Initial draft for remaining resources consolidation (Phase 3) | Winston (Architect) |
