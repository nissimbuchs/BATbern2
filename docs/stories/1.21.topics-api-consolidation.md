# Story 1.21: Topics API Consolidation

## Status
Approved

## Story

**As an** organizer,
**I want** consolidated Topics APIs with AI-powered similarity analysis,
**so that** I can manage the topic backlog efficiently with intelligent suggestions.

## Domain Context

### Primary Domain
Event Management Domain - Topic backlog, similarity analysis, AI suggestions, voting

### Involved Services
- Event Management Service (primary - topics subdomain)
- API Gateway (routing, middleware)
- Shared Kernel (query utilities from Story 1.16)
- Lambda (AI/ML similarity analysis)

### Cross-Domain Dependencies
- **Depends on**: Story 1.16 (API Consolidation Foundation)
- **Depends on**: Story 1.17 (Events API) for topic-event relationships
- **Integrates with**: Partner Analytics Service for voting data

## Requirements Context

### Related Functional Requirements
- **FR3**: Topic backlog management
- **FR19**: AI-powered topic similarity
- **FR20**: Topic voting and prioritization

### Acceptance Criteria Source
API Consolidation Analysis (docs/api-consolidation-analysis.md), Section 3.5 - Topics Domain

## Architecture Context

### Architecture Patterns
[Source: docs/api-consolidation-analysis.md]
- **Before**: 52 endpoints
- **After**: 12 endpoints
- **Reduction**: 77%
- **Similarity Analysis**: ML-based topic clustering
- **Voting Consolidation**: Aggregate voting data

## Wireframe Context

### Wireframe References
- `story-2.2-topic-backlog-management.md`
- `story-2.2-topic-detail-screen.md`
- `story-6.4-topic-voting.md`

## Acceptance Criteria

1. **List Topics**: `GET /api/v1/topics?filter={}&sort={}&page={}`
2. **Get Topic**: `GET /api/v1/topics/{id}?include=history,similarity,votes,events`
3. **Topic CRUD**: POST/PUT/PATCH/DELETE `/api/v1/topics`
4. **Similarity**: `GET /api/v1/topics/{id}/similarity?threshold=0.8`
5. **History**: `GET /api/v1/topics/{id}/history`
6. **Voting**: `GET /api/v1/topics/{id}/votes`
7. **AI Suggestions**: `GET /api/v1/topics/ai-suggestions?context={}`
8. **Trending**: `GET /api/v1/topics/trending?timeframe=week`
9. **Statistics**: `GET /api/v1/topics/statistics?groupBy=category`
10. **Merge Topics**: `POST /api/v1/topics/merge`
11. **Archive**: `POST /api/v1/topics/{id}/archive`

## Consolidated Endpoints (12 Total)

```
GET    /api/v1/topics?filter={}&sort={}&page={}
GET    /api/v1/topics/{id}?include=history,similarity,votes,events
POST   /api/v1/topics
PUT    /api/v1/topics/{id}
PATCH  /api/v1/topics/{id}
DELETE /api/v1/topics/{id}

GET    /api/v1/topics/{id}/similarity?threshold={}
GET    /api/v1/topics/{id}/history
GET    /api/v1/topics/{id}/votes

GET    /api/v1/topics/ai-suggestions?context={}
GET    /api/v1/topics/trending?timeframe={}
GET    /api/v1/topics/statistics?groupBy={}

POST   /api/v1/topics/merge
POST   /api/v1/topics/{id}/archive
```

## Performance Requirements

- Topic list with filters: <200ms (P95)
- Similarity analysis: <800ms (P95)
- AI suggestions: <1s (P95)

## Definition of Done

- [ ] All 11 ACs implemented
- [ ] 52 â†’ 12 endpoints consolidation verified
- [ ] 3 wireframes migrated
- [ ] AI similarity working
- [ ] Tests >90% coverage

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2024-10-04 | 1.0 | Topics API consolidation | Winston (Architect) |
