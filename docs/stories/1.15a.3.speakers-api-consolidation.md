# Story 1.15a.3: Speakers API Consolidation

## Status
Approved

## Story

**As a** speaker,
**I want** consolidated Speaker APIs for managing my profile and event materials,
**so that** I can access all my speaking engagements and materials in one request.

## Domain Context

### Primary Domain
Speaker Coordination Domain - Speaker profiles, event materials, availability, feedback

### Involved Services
- Speaker Coordination Service (primary)
- API Gateway (routing, middleware)
- Shared Kernel (query utilities from Story 1.15a)
- S3 (material storage)

### Cross-Domain Dependencies
- **Depends on**: Story 1.15a (API Consolidation Foundation)
- **Depends on**: Story 1.15a.1 (Events API) for speaker-event relationships
- **Integrates with**: Company Management Service for speaker companies

## Requirements Context

### Related Functional Requirements
- **FR6**: Speaker material submission
- **FR18**: Speaker profile management
- **FR7**: Speaker availability tracking

### Acceptance Criteria Source
API Consolidation Analysis (docs/api-consolidation-analysis.md), Section 3.3 - Speakers Domain

## Architecture Context

### Architecture Patterns
[Source: docs/api-consolidation-analysis.md]
- **Before**: 70 speaker endpoints + 13 invitation endpoints + 5 presentation endpoints = 88 total
- **After**: 24 consolidated endpoints
- **Reduction**: 73%
- **Event Materials Nesting**: `/speakers/{id}/events/{eventId}/materials`
- **Timeline Integration**: `?include=timeline`
- **Invitations**: Integrated into Speaker Coordination domain (moved from Story 1.15a.11)
- **Presentations**: Linked to speakers and events (moved from Story 1.15a.11)

## Wireframe Context

### Wireframe References
- `story-3.1-speaker-matching-interface.md`
- `story-3.3-presentation-upload.md`
- `story-3.5-event-timeline.md`
- `story-7.1-speaker-profile-management.md`

## Acceptance Criteria

1. **List Speakers**: `GET /api/v1/speakers` with filtering
2. **Get Speaker**: `GET /api/v1/speakers/{id}?include=profile,events,materials,timeline,feedback`
3. **Speaker CRUD**: POST/PUT/PATCH/DELETE `/api/v1/speakers`
4. **Speaker Events**: `GET /api/v1/speakers/{id}/events?filter={}`
5. **Event Detail**: `GET /api/v1/speakers/{id}/events/{eventId}?include=timeline,materials,checklist`
6. **Materials CRUD**: POST/PUT/DELETE `/api/v1/speakers/{id}/events/{eventId}/materials/{materialId}`
7. **Feedback**: `GET /api/v1/speakers/{id}/feedback`
8. **Ratings**: `POST /api/v1/speakers/{id}/ratings`
9. **Availability**: GET/PUT `/api/v1/speakers/{id}/availability`
10. **History**: `GET /api/v1/speakers/{id}/history`
11. **Directory**: `GET /api/v1/speakers/directory?filter={}`
12. **Invitations List**: `GET /api/v1/invitations?filter={}&page={}`
13. **Invitation CRUD**: GET/POST/PUT/DELETE `/api/v1/invitations/{id}`
14. **Accept Invitation**: `PUT /api/v1/invitations/{id}/accept`
15. **Decline Invitation**: `PUT /api/v1/invitations/{id}/decline`
16. **Presentations**: `GET /api/v1/presentations?speakerId={}&eventId={}`

## Consolidated Endpoints (24 Total)

```
# Speaker Management
GET    /api/v1/speakers?filter={}&sort={}&page={}
GET    /api/v1/speakers/{id}?include=profile,events,materials,timeline,feedback
POST   /api/v1/speakers
PUT    /api/v1/speakers/{id}
PATCH  /api/v1/speakers/{id}
DELETE /api/v1/speakers/{id}

# Speaker Events & Materials
GET    /api/v1/speakers/{id}/events?filter={}&page={}
GET    /api/v1/speakers/{id}/events/{eventId}?include=timeline,materials,checklist

POST   /api/v1/speakers/{id}/events/{eventId}/materials
PUT    /api/v1/speakers/{id}/events/{eventId}/materials/{materialId}
DELETE /api/v1/speakers/{id}/events/{eventId}/materials/{materialId}

# Speaker Feedback & Ratings
GET    /api/v1/speakers/{id}/feedback?filter={}
POST   /api/v1/speakers/{id}/ratings

# Speaker Availability & History
GET    /api/v1/speakers/{id}/availability
PUT    /api/v1/speakers/{id}/availability

GET    /api/v1/speakers/{id}/history?page={}
POST   /api/v1/speakers/{id}/export
GET    /api/v1/speakers/directory?filter={}&page={}

# Speaker Invitations (moved from Story 1.15a.11)
GET    /api/v1/invitations?filter={}&page={}
GET    /api/v1/invitations/{id}
POST   /api/v1/invitations
PUT    /api/v1/invitations/{id}/accept
PUT    /api/v1/invitations/{id}/decline
DELETE /api/v1/invitations/{id}

# Presentations (moved from Story 1.15a.11)
GET    /api/v1/presentations?speakerId={}&eventId={}
GET    /api/v1/presentations/{id}
POST   /api/v1/presentations
```

## Performance Requirements

- Speaker detail with events: <400ms (P95)
- Speaker directory search: <300ms (P95)
- Material upload: <2s (P95)

## Definition of Done

- [ ] All 16 ACs implemented (includes new invitations and presentations)
- [ ] 88 → 24 endpoints consolidation verified
- [ ] 4 wireframes migrated
- [ ] Material nesting working
- [ ] Speaker invitation workflow implemented
- [ ] Invitation accept/decline actions working
- [ ] Presentations linked to speakers and events
- [ ] Tests >90% coverage

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-12 | 2.0 | Added Invitations (6 endpoints) and Presentations (3 endpoints) from Story 1.15a.11; updated totals to 88→24 | Winston (Architect) |
| 2024-10-04 | 1.0 | Initial draft for speakers API consolidation | Winston (Architect) |
