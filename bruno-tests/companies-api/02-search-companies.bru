meta {
  name: Search Companies (with headers)
  type: http
  seq: 2
}

get {
  url: {{baseUrl}}/companies/search?query=test&limit=10
  body: none
  auth: bearer
}

auth:bearer {
  token: {{authToken}}
}

headers {
  X-Correlation-ID: {{$guid}}
  Accept-Language: en-US
  Accept: application/json
}

params:query {
  query: test
  limit: 10
}

assert {
  res.status: in [200, 401]
}

tests {
  test("should return 200 or 401 (auth dependent)", function() {
    const status = res.getStatus();
    expect([200, 401]).to.include(status);
  });

  test("should accept custom headers without CORS error", function() {
    // If we got 200 or 401, headers were accepted
    // CORS error would be caught before reaching backend
    const status = res.getStatus();
    expect(status).to.be.a('number');
  });

  if (res.getStatus() === 200) {
    test("should return array of search results", function() {
      expect(res.getBody()).to.be.an('array');
    });
  }
}
